angular.module("navBar",[]).directive("navdirective",["$localStorage","$state","$location","$window","$rootScope","$log","$alert",function(e,o,t,n,r,a,i){return{restrict:"E",templateUrl:"components/shared/navbar/navBarTemplate.html",link:function(t,n,r){t.Logout=function(){confirm("Are you sURE")?(delete e.newToken,i({title:"Please Login",placement:"bottom",type:"danger",show:!0}),o.go("Login")):o.go("home")}}}}]),angular.module("navBar").factory("resourceFactory",["$resource","$localStorage",function(e,o){function t(){var e=o.newToken;return{Authorization:e}}var n=t(),r={get:{method:"GET",headers:n},save:{method:"POST",headers:n},create:{method:"POST",headers:n},query:{method:"GET",isArray:!0,headers:n},remove:{method:"DELETE",headers:n},delete:{method:"DELETE",headers:n},update:{method:"PUT",headers:n}},a=e("/api/movies/:id",{id:"@id"},r);return a}]),angular.module("homeApp",[]).controller("homeController",["$rootScope","$scope","resourceFactory","$alert",function(e,o,t,n){o.a=t.query(function(e,o){},function(e){console.log(e)}),o.DeleteMovie=function(e){alert("Are you sure"),t.delete({id:e},function(e){o.entry=t;var r=t.query(function(){o.a=r,n({title:"Movie Deleted",placement:"top",type:"info",show:!0})})})}}]),angular.module("viewApp",[]).controller("viewController",["$scope","$stateParams","resourceFactory",function(e,o,t){e.entry=t.get({id:o.id},function(){e.Movie=e.entry})}]),angular.module("AddMovie",[]).controller("AddNewMovieController",["$scope","$rootScope","resourceFactory","$modal","$state",function(e,o,t,n,r){var a=n({scope:e,templateUrl:"/components/addmovie/addNewMovieModal.html",show:!1});console.log("shshs"),e.data={},e.getError=function(e){if(angular.isDefined(e)){if(e.required)return"Please Add a Value";if(e.email)return"Enter a Validd Email"}},e.AddMovie=function(o){e.newMovie=new t,e.newMovie.MovieData=o,t.save(e.newMovie,function(){e.data={},a.$promise.then(a.show)})},e.GoHome=function(){a.$promise.then(a.hide),r.go("home")}}]),angular.module("editApp",[]).controller("editController",["$scope","$stateParams","resourceFactory","$location","$localStorage","$modal","$state",function(e,o,t,n,r,a,i){var l=a({scope:e,templateUrl:"/components/edit/editMovieModal.html",show:!1});e.entry=t.get({id:o.id},function(){e.data=e.entry}),e.UpdateMovie=function(o){t.update({id:o},e.data,function(){l.$promise.then(l.show)})},e.GoHome=function(){l.$promise.then(l.hide),i.go("home")}}]),angular.module("AuthenticationApp",[]).factory("RegisterFactory",["$resource",function(e){return e("/users/signup/:id",{},{delete:{method:"DELETE",params:{id:"id"}},update:{method:"PUT",params:{id:"id"}}})}]),angular.module("AuthenticationApp").factory("LoginFactory",["$resource",function(e){return e("/users/login/:id",{},{delete:{method:"DELETE",params:{id:"id"}},update:{method:"PUT",params:{id:"id"}}})}]),angular.module("AuthenticationApp").factory("GetTokenFactory",function(){var e={};return e.GetToken=function(e){return!!e},e}),angular.module("AuthenticationApp").controller("AuthenticationController",["$scope","$rootScope","RegisterFactory","LoginFactory","$state","$localStorage","$alert",function(e,o,t,n,r,a,i){e.RegisterUser=function(o){e.newUser=new t,e.newUser.data=o,t.save(e.newUser,function(e,o){r.go("Login")})},e.GoHome=function(){aside.$promise.then(aside.hide)},e.LoginUser=function(o){e.newUser=new n,e.newUser.LoginData=o,n.save(e.newUser,function(e){0==e.success?alert(e.message):(a.newToken=e.token,i({title:"Login Successful",placement:"top",type:"info",show:!0}),r.go("home"))})}}]);var app=angular.module("MovieApp",["navBar","ui.router","AuthenticationApp","ngResource","homeApp","ngStorage","AddMovie","editApp","viewApp","mgcrea.ngStrap","mgcrea.ngStrap.alert","mgcrea.ngStrap.aside"]);app.run(["GetTokenFactory","$localStorage","$rootScope","$state","$alert","$location",function(e,o,t,n,r,a){t.preventNavigation=!1,t.$on("$stateChangeStart",function(n,a,i){0!=a.authenticate&&(!e.GetToken(o.newToken)||t.preventNavigation&&!confirm("You have unsaved changes, do you want to continue?"))&&(n.preventDefault(),r({title:"Please Login",placement:"top",type:"info",show:!0}))})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("/user/login"),e.state("home",{url:"/home",templateUrl:"components/home/homeView.html",controller:"homeController"}).state("viewMovie",{url:"/view/movie/:id",templateUrl:"components/view/view.html",controller:"viewController"}).state("EditMovie",{url:"/edit/movie/:id",templateUrl:"components/edit/editView.html",controller:"editController"}).state("NewMovie",{url:"/add/movie",templateUrl:"components/addmovie/addnewmovie.html",controller:"AddNewMovieController"}).state("Register",{url:"/user/signup",templateUrl:"components/Authentication/registerView.html",controller:"AuthenticationController",authenticate:!1}).state("Login",{url:"/user/login",templateUrl:"components/Authentication/LoginView.html",controller:"AuthenticationController",authenticate:!1})}]);